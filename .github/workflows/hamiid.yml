name: Windows RDP Optimized
on: workflow_dispatch

jobs:
  build:
    runs-on: windows-latest
    steps:

      # ============================================================
      # 1. CREATE USER + ENABLE RDP
      # ============================================================
      - name: Enable RDP + Create User
        shell: powershell
        run: |

          # Strong password (VALID for GitHub Windows Server)
          $password = "aves!@#masoom!@#12"
          $securePass = ConvertTo-SecureString $password -AsPlainText -Force

          # Create or update user 'hamid'
          if (Get-LocalUser -Name "hamid" -ErrorAction SilentlyContinue) {
              Set-LocalUser -Name "hamid" -Password $securePass
          } else {
              New-LocalUser -Name "hamid" -Password $securePass -AccountNeverExpires:$true
          }

          # Add to RDP group
          Add-LocalGroupMember -Group "Remote Desktop Users" -Member "hamid"

          # Enable RDP globally
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\' `
            -Name "fDenyTSConnections" -Value 0

          # Fix for GitHub RDP compatibility
          Set-ItemProperty `
