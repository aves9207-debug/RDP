    - name: Install RPCS3 + Full Optimizations + Vulkan Speed Hack
      run: |
        Write-Host "[+] Installing RPCS3..."

        # Download RPCS3
        Invoke-WebRequest "https://github.com/RPCS3/rpcs3-binaries-win/releases/latest/download/rpcs3-windows-x64.zip" -OutFile "rpcs3.zip"
        Expand-Archive "rpcs3.zip" -DestinationPath "C:\RPCS3" -Force

        # Install VC++ runtime
        Write-Host "[+] Installing VC++ Runtime..."
        Invoke-WebRequest "https://aka.ms/vs/17/release/vc_redist.x64.exe" -OutFile "vc.exe"
        Start-Process "vc.exe" -ArgumentList "/install /quiet /norestart" -Wait

        # RPCS3 config directory
        $configPath = "C:\Users\Gamer\AppData\Roaming\rpcs3"
        New-Item -ItemType Directory -Path $configPath -Force | Out-Null

        Write-Host "[+] Applying RPCS3 performance config..."

        @"
Version: 1
PPU Decoder: "LLVM Recompiler"
SPU Decoder: "LLVM Recompiler"
SPU Lower Thread Priority: true
Renderer: "Vulkan"
Resolution Scale: 50
Thread Scheduler: true
Low Memory Mode: true
Write Debug Logs: false
Write TTY: false

# Vulkan Speed Hack for WARP
Disable Vulkan Shader Validation: true
Disable FIFO Reordering: true
Asynchronous Shader Compiler: true
Driver Recovery Timeout: false
Force FIFO Accurate RSX: false
Disable ZCull Occlusion Queries: true
Disable Vertex Cache: false
Accurate SPU DMA: false
Accurate RSX reservation access: false
Accurate Memory Access: false
Accurate Shader Status Updates: false
Accurate Color and Depth: false
Skip Duplicate Render Targets: true
Prefer Linked SPU Threads: false
"@ | Out-File -Encoding utf8 "$configPath\config.yml"

        Write-Host "[+] Applying Vulkan WARP registry tweaks..."

        # Makes WARP faster + lower precision math
        reg add "HKLM\SOFTWARE\Microsoft\Direct3D\Drivers" /v WARPSoftwareDevice /t REG_DWORD /d 1 /f
        reg add "HKLM\SOFTWARE\Microsoft\Direct3D" /v AllowLowPrecisionMath /t REG_DWORD /d 1 /f
        reg add "HKLM\SOFTWARE\Microsoft\Direct3D" /v WarpFastMath /t REG_DWORD /d 1 /f

        # Improve Vulkan pipeline performance
        reg add "HKLM\SOFTWARE\Khronos\Vulkan\ImplicitLayers" /f

        # Boost system for emulator
        Write-Host "[+] Boosting system thread priority..."
        powercfg -setactive e9a42b02-d5df-448d-aa00-03f14749eb61
        reg add "HKLM\SYSTEM\CurrentControlSet\Control\PriorityControl" /v Win32PrioritySeparation /t REG_DWORD /d 38 /f

        Write-Host "[+] RPCS3 + Vulkan Speed Hack DONE"
